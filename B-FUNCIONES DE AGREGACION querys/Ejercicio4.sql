SELECT 
	TIPO,
	SUM(PRECIO_ORI) AS TOTAL_PRECIOS_ORI,
	AVG(PRECIO_ACT) AS PROMEDIO_PRECIOS_ACT
FROM LIBRO
WHERE EDICION <> 1946
GROUP BY TIPO
HAVING SUM(PRECIO_ORI) > 40